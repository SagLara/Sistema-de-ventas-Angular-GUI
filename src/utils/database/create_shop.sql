/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 13.5 		*/
/*  Created On : 18-may.-2021 1:48:29 p. m. 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */

--
-- Base de datos: `shop`
--

SET FOREIGN_KEY_CHECKS=0 
;

/* Drop Tables */

DROP TABLE IF EXISTS `CLIENTE` CASCADE
;

DROP TABLE IF EXISTS `DETALLE_VENTA` CASCADE
;

DROP TABLE IF EXISTS `INFORME` CASCADE
;

DROP TABLE IF EXISTS `PRODUCTO` CASCADE
;

DROP TABLE IF EXISTS `REGISTRO_VENTA` CASCADE
;

DROP TABLE IF EXISTS `UBICACION` CASCADE
;

/* Create Tables */

CREATE TABLE `CLIENTE`
(
	`ID_CLIENTE` INT NOT NULL AUTO_INCREMENT,
	`DOCUMENTO` VARCHAR(50) NOT NULL,
	`TIPO_DOC` VARCHAR(5) NOT NULL,
	`NOMBRES` VARCHAR(50) NOT NULL,
	`APELLIDOS` VARCHAR(50) NOT NULL,
	CONSTRAINT `PK_CLIENTE` PRIMARY KEY (`ID_CLIENTE` ASC)
)

;

CREATE TABLE `DETALLE_VENTA`
(
	`ID_REGISTRO` INT NOT NULL,
	`ID_PRODUCTO` INT NOT NULL,
	`CANTIDAD` DECIMAL(5,0) NOT NULL,
	`VALOR_X_CANT` DECIMAL(13,2) NOT NULL
)

;

CREATE TABLE `INFORME`
(
	`ID_INFORME` INT NOT NULL AUTO_INCREMENT,
	`FECHA` DATE NOT NULL,
	`CANT_VENTAS` DECIMAL(5,0) NULL,
	`VENTA_MAYOR` DECIMAL(13,2) NULL,
	`VENTA_MENOR` DECIMAL(13,2) NULL,
	`VENTA_PROMEDIO` DECIMAL(13,2) NULL,
	CONSTRAINT `PK_INFORME` PRIMARY KEY (`ID_INFORME` ASC)
)

;

CREATE TABLE `PRODUCTO`
(
	`ID_PRODUCTO` INT NOT NULL AUTO_INCREMENT,
	`NOMBRE` VARCHAR(50) NOT NULL,
	`PRECIO` DECIMAL(10,2) NOT NULL,
	`STOCK` INT NULL,
	CONSTRAINT `PK_PRODUCTO` PRIMARY KEY (`ID_PRODUCTO` ASC)
)

;

CREATE TABLE `REGISTRO_VENTA`
(
	`ID_REGISTRO` INT NOT NULL AUTO_INCREMENT,
	`FECHA` DATETIME NULL,
	`ID_CLIENTE` INT NULL,
	`VALOR_TOTAL_VENTA` BIGINT NOT NULL,
	`ID_INFORME` INT NOT NULL,
	CONSTRAINT `PK_REGISTRO_VENTA` PRIMARY KEY (`ID_REGISTRO` ASC)
)

;
CREATE TABLE `UBICACION`
(
	`ID_UBICACION` INT NOT NULL AUTO_INCREMENT,
	`ID_CLIENTE` INT NOT NULL,
	`CIUDAD` VARCHAR(50) NULL,
	`LATITUD` NUMERIC(18,15) NOT NULL,
	`LONGITUD` NUMERIC(18,15) NOT NULL,
	CONSTRAINT `PK_UBICACION` PRIMARY KEY (`ID_UBICACION` ASC)
)

;


/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `CLIENTE` 
 ADD CONSTRAINT `UQ_DOCUMENTO` UNIQUE (`DOCUMENTO` ASC)
;

ALTER TABLE `DETALLE_VENTA` 
 ADD INDEX `IXFK_DETALLE_VENTA_PRODUCTO` (`ID_PRODUCTO` ASC)
;

ALTER TABLE `DETALLE_VENTA` 
 ADD INDEX `IXFK_DETALLE_VENTA_REGISTRO_VENTA` (`ID_REGISTRO` ASC)
;

ALTER TABLE `INFORME` 
 ADD CONSTRAINT `UQ_FECHA` UNIQUE (`FECHA` ASC)
;

ALTER TABLE `REGISTRO_VENTA` 
 ADD INDEX `IXFK_REGISTRO_VENTA_CLIENTE` (`ID_CLIENTE` ASC)
;

ALTER TABLE `REGISTRO_VENTA` 
 ADD INDEX `IXFK_REGISTRO_VENTA_INFORME` (`ID_INFORME` ASC)
;

ALTER TABLE `UBICACION` 
 ADD INDEX `IXFK_UBICACION_CLIENTE` (`ID_CLIENTE` ASC)
;

ALTER TABLE `UBICACION` 
 ADD CONSTRAINT `UQ_ID_CLIENTE` UNIQUE (`ID_CLIENTE` ASC)
;

/* Create Foreign Key Constraints */

ALTER TABLE `DETALLE_VENTA` 
 ADD CONSTRAINT `FK_DETALLE_VENTA_PRODUCTO`
	FOREIGN KEY (`ID_PRODUCTO`) REFERENCES `PRODUCTO` (`ID_PRODUCTO`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `DETALLE_VENTA` 
 ADD CONSTRAINT `FK_DETALLE_VENTA_REGISTRO_VENTA`
	FOREIGN KEY (`ID_REGISTRO`) REFERENCES `REGISTRO_VENTA` (`ID_REGISTRO`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `REGISTRO_VENTA` 
 ADD CONSTRAINT `FK_REGISTRO_VENTA_CLIENTE`
	FOREIGN KEY (`ID_CLIENTE`) REFERENCES `CLIENTE` (`ID_CLIENTE`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `REGISTRO_VENTA` 
 ADD CONSTRAINT `FK_REGISTRO_VENTA_INFORME`
	FOREIGN KEY (`ID_INFORME`) REFERENCES `INFORME` (`ID_INFORME`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `UBICACION` 
 ADD CONSTRAINT `FK_UBICACION_CLIENTE`
	FOREIGN KEY (`ID_CLIENTE`) REFERENCES `CLIENTE` (`ID_CLIENTE`) ON DELETE Restrict ON UPDATE Restrict
;

SET FOREIGN_KEY_CHECKS=1 
;
